single_spatial_plot<-function(geneName1,data_mat,genes,x,y,color_palette){
  gene2plot<-data.frame(x=x,y=y,expression=log2(as.numeric(data_mat[genes==geneName1,][1,])+0.1))
  mid<-(quantile(gene2plot$expression,0.9) + quantile(gene2plot$expression,0.1))/2
  p1<-ggplot(gene2plot,aes(x=x,y=y)) + geom_point(shape=21,color='grey90',aes(fill=expression),size=2) + scale_fill_gradient2(name="Log2\n(values+0.1)",midpoint=mid, low="blue", mid="white",high="red") + xlab("Horizontal position") + ylab("Vertical") + coord_equal() + ggtitle(geneName1) +theme(plot.margin = unit(c(0.1,0.1,0.1,0),"cm"),axis.text.x = element_text(size=15),axis.text.y = element_text(size=15),axis.title = element_text(size=17),panel.background = element_blank(),legend.title=element_text(size=17),legend.text = element_text(size=12),plot.title = element_text(hjust = 0.5,face='bold',size=20))
  #p1<-ggplot(gene2plot,aes(x=x,y=y)) + geom_point(shape=21,color='black',aes(fill=expression),size=2) + scale_fill_gradientn(name="Log2\n(values+0.1)",colors=color_palette) + xlab("X position") + ylab("Y position") + coord_equal() + ggtitle(geneName1) +theme(plot.margin = unit(c(0.1,0.1,0.1,0),"cm"),axis.text.x = element_text(size=15),axis.text.y = element_text(size=15),axis.title = element_text(size=17),panel.background = element_blank(),legend.title=element_text(size=17),legend.text = element_text(size=15),plot.title = element_text(hjust = 0.5,face='bold',size=20))
  #p1<-ggplot(gene2plot,aes(x=x,y=y)) + geom_point(aes(color=expression),size=2) + scale_color_gradient2(name="Log2\n(values+0.1)",midpoint=mid, low="blue", mid="black",high="yellow") + xlab("X position") + ylab("Y position") + coord_equal() + ggtitle(geneName1) +theme(plot.margin = unit(c(0.1,0.1,0.1,0),"cm"),axis.text.x = element_text(size=15),axis.text.y = element_text(size=15),axis.title = element_text(size=17),panel.background = element_blank(),legend.title=element_text(size=17),legend.text = element_text(size=15),plot.title = element_text(hjust = 0.5,face='bold',size=20))
  return(p1)
}